---
layout: single
title:  "Ch2.운영체제 핵심개념"
tag: [CS, OS]
toc: true
---

# 운영체제 구조

## 시스템 콜

#### 도서관으로 비유

- 운영체제는 도서관
- 응용프로그램은 시민
- 컴퓨터 하드웨어는 책
- 운영체제의 역할
  - 시민은 도서관에 원하는 책(자원)을 요청함
  - 도서관은 적절한 책(자원)을 찾아서 , 시민에게 빌려줌
  - 시민이 기한이 다 되면, 도서관이 해당 책(자원)을 회수함



### 응용프로그램, 운영체제, 컴퓨터 하드웨어 관계

- 운영체제는 응용프로그램이 요청하는 메모리를 허가하고, 분배한다.
- 운영체제는 응요프로그램이 요청하는 CPU시간을 제공한다.
- 운영체제는 응요프로그램이 요청하는 IO Devices 사용을 허가/제어한다.



### 사용자, 응용 프로그램, 운영체제, 컴퓨터 하드웨어 관계

![운영체제구조](../images/21-10-23-OS-2/운영체제구조.png)

> 출처: 위키피디아



### 운영체제는 사용자 인터페이스 제공

- 쉘(Shell)
  - 사용자가 운영체제 기능과 서비스를 조작할 수 있도록 인터페이스를 제공하는 프로그램(응용프로그램)
  - 쉘은 터미널 환경(CLI)과 GUI환경 두 종류로 분류



### 운영체제는 응용 프로그램을 위해서도 인터페이스를 제공

- API (Application Programming Interface)
  - 함수로 제공
  - open()
- 보통은 라이브러리(library) 형태로 제공
  - C library

#### 시스템콜

- 시스템 콜 또는 시스템 호출 인터페이스
- 운영체제가 운영체제 각 기능을 사용할 수 있도록 시스템 콜이라는 명령 또는 함수를 제공
- API 내부에는 시스템콜을 호출하는 형태로 만들어지는 경우가 대부분

### 운영체제와 시스템 콜

- 시스템 콜 정의 예
  - POSIX API, 윈도우 API

> API: 각 언어별 운영체제 기능 호출 인터페이스 함수 (각 언어별 인터페이스)
>
> 시스템콜: 운영체제 기능을 호출하는 함수



#### 정리

- 운영체제는 컴퓨터 하드웨어와 응용프로그램을 관리한다.
- 사용자 인터페이스를 위해 쉘 프로그램을 제공한다.
- 응용프로그램이 운영체제에 기능을 요청하기 위해서, 운영체제는 시스템 콜을 제공한다.
  - 보통 시스템 콜을 직접 사용하기 보드는, 해당 시스템 콜을 사용해서 만든 각 언어별 라이브러리(API)를 사용한다.<img src="../images/21-10-23-OS-2/스크린샷 2021-10-26 오후 1.41.50.png" alt="스크린샷 2021-10-26 오후 1.41.50" style="zoom:33%;" />



## 사용자와 커널 모드

### CPU Protection Rings

- CPU도 권한 모드라는 것을 가지고 있다.

  - 사용자 모드(user mode by applications)
  - 커널 모드(kernel mode by OS): 특권 명령어 실행과 원하는 작업 수행을 위한 자원 접근을 가능케 하는 모드

  <img src="../images/21-10-23-OS-2/스크린샷 2021-10-27 오후 10.57.34.png" alt="스크린샷 2021-10-27 오후 10.57.34" style="zoom:50%;" />

  > kernel 이란 ? OS kernel

  1. (견과류,씨앗)의 알맹이
  2. (사상, 주제)의 핵심

  > Shell 이란?

  1. (달걀견과류 등의 딱딱한) 껍데기
  2. 고둥 껍데기 모양의 것



#### 두 가지 모드

- 사용자 모드(user mode): 응용 프로그램이 사용
- 커널 모드(kernel mode): OS가 사용

<img src="../images/21-10-23-OS-2/스크린샷 2021-10-27 오후 11.02.17.png" alt="스크린샷 2021-10-27 오후 11.02.17" style="zoom: 33%;" />

### 응용 프로그램과 운영체제

- 우리가 만드는 프로그램은 맨위에서 놀고 있다.

<img src="../images/21-10-23-OS-2/스크린샷 2021-10-27 오후 11.03.47.png" alt="스크린샷 2021-10-27 오후 11.03.47" style="zoom:50%;" />

### 시스템 콜은 커널 모드로 실행

- 커널 모드에서만 실행 가능한 기능들이 있음
- 커널 모드로 실행하려면, 반드시 시스템 콜을 사용해야 함(거쳐야 함)
- 시스템 콜은 운영체제 제공

### 사용자 모드와 커널 모드

- 함부로 응용 프로그램이 전체 컴퓨터 시스템을 헤치지 못함
- 주민등록등본은 꼭 동사무소 또는 민원 24시(정부 사이트)(**사용자모드**)에서 특별한 신청서(**시스템콜**)를 써야만, 발금
  - 동사무소 직원분들은 특별한 권한을 가지고, 주민등록등본 출력 명령을 실행(**커널모드**)

### Code example 1

<img src="../images/21-10-23-OS-2/스크린샷 2021-10-27 오후 11.08.46.png" alt="스크린샷 2021-10-27 오후 11.08.46" style="zoom:33%;" />

### Code example 2

<img src="../images/21-10-23-OS-2/스크린샷 2021-10-27 오후 11.10.54.png" alt="스크린샷 2021-10-27 오후 11.10.54" style="zoom:50%;" />

### 정리

- 운영체제는 **시스템 콜** 제공
- 프로그래밍 언어별로 운영체제 기능을 활용하기 위해, 시스템 콜을 기반으로 **API** 제공
- 응용 프로그램은 운영체제 기능 필요시, 해당 **API** 를 사용해서 프로그램을 작성
- 응용 프로그램이 실행되서, 운영체제 기능이 필요한 **API** 를 호출하면, 시스템 콜이 호출되서, **커널 모드로 변경되어** OS 내부에서 해당 명령이 실행되고, 다시 응용 프로그램으로 돌아간다.

